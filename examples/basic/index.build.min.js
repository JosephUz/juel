!function(){return function t(e,n,r){function i(s,c){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[s]={exports:{}};e[s][0].call(p.exports,function(t){return i(e[s][1][t]||t)},p,p.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}}()({1:[function(t,e,n){const r=t("../../index.js");var i=r.scope({todoList:[{id:1,text:"Item1",count:0},{id:2,text:"Item2",count:0},{id:3,text:"Item3",count:0}]});r.template.read(),r.template.set("scopeShowBtn",'<button click="{{click}}">Show Scope On Console</button>'),r.template.set([{name:"changeListBtn",html:'<button id="changeListBtn" click="{{ click }}">Change List</button>'},{name:"countItem",html:'<li>{{ text }}{{ count ? " - " + count + " Time" + (count > 1 ? "s": "") + " Clicked" : "" }}</li>'},{name:"countList",html:"<ul>Clicked Counts {{ todoList.map(addItem) }} NOT: if not clicked, number doesnt show</ul>"}]),r.append("#changeList","changeListBtn",{},{click:function(t){i.todoList=[{id:1,text:"Item1",count:0},{id:2,text:"Item2",count:0},{id:3,text:"Item3",count:0},{id:4,text:"Item4",count:0},{id:5,text:"Item5",count:0}]}});var o=r.append("#todoList","todoList",i,{addItem:function(t){return r.create("todoItem",t,{click:function(t){this.count+=1}.bind(t)}).toHTML()}}).setId("todoList");console.log(o==r.get("todoList"));var s=r.append("#countList","countList",i,{addItem:function(t){return r.create("countItem",t).toHTML()}}).setId("countList");console.log(s==r.get("todoList")),r.append("#showScope","scopeShowBtn",{},{click:function(t){console.log(JSON.stringify(this.toJSON()))}.bind(i)})},{"../../index.js":2}],2:[function(t,e,n){const r=t("./libs/juel"),i=t("./libs/parser"),o=t("./libs/evaluator"),s=t("./libs/template"),c=t("./libs/cache"),a=t("./libs/scope");(n={}).template=s,n.cache=c,n.get=c.get,n.append=function(t,e,r,i){var o=null;if(!t||"string"!=typeof t||"string"!=typeof e)throw new Error("missing arguments");return t=document.querySelector(t),o=n.create(e,r,i),t.append(o.toHTML()),o},n.create=function(t,e,n){var c,a=null,u=null;if("string"!=typeof t||"object"!=typeof e||n&&"object"!=typeof n)throw new Error("missing arguments");if(!(u=s.get(t)))throw new Error("empty html");return a=(c=i(u)).scripts.length>0?o(c,e,n):null,r(c,a)},n.scope=function(t){if("object"!=typeof t)throw new Error("parameter must be an object");return a(t)},e.exports=n},{"./libs/cache":3,"./libs/evaluator":5,"./libs/juel":6,"./libs/parser":10,"./libs/scope":13,"./libs/template":15}],3:[function(t,e,n){var r={};(n={}).set=function(t){r[t.id]=t},n.get=function(t){return r[t]},n.delete=function(t){delete r[t]},n.clear=function(){r={}},n.list=function(){return Object.keys(r).map(function(t){return n.get(t)})},e.exports=n},{}],4:[function(t,e,n){const r=t("../scope");function i(t,e,n){var i=this;this.scope=r(e),this.common=n,this.scripts=t.scripts,this.params=null,this.scope.onChange(function(t,e){i.refresh(t,e)})}i.prototype.refresh=function(t,e){var n=this;return this.params=this.scope.keys.map(function(t){return" var "+t+" = scope."+t+";"}).join(" "),this.common&&(this.params=this.params.concat(Object.keys(this.common).map(function(t){return" var "+t+" = common."+t+";"}).join(" "))),this.scripts.forEach(function(e){t&&!e.exist(t)||e.refresh(n)}),this},e.exports=i},{"../scope":13}],5:[function(t,e,n){const r=t("./evaluator.js");e.exports=function(t,e,n){return new r(t,e,n).refresh()}},{"./evaluator.js":4}],6:[function(t,e,n){const r=t("./juel.js");e.exports=function(t,e){return new r(t,e)}},{"./juel.js":7}],7:[function(t,e,n){const r=t("../cache");function i(t,e){this.id=null,this.parsered=t,this.evaluated=e,Object.defineProperties(this,{scope:{get:function(){return this.evaluated.scope}}})}i.prototype.toHTML=function(){return this.parsered.toHTML()},i.prototype.setId=function(t){return this.id=t,r.set(this),this},e.exports=i},{"../cache":3}],8:[function(t,e,n){const r=t("../juel/juel.js"),i=t("./attribute.js");function o(t,e){var n=this;this.type=t.type,this.content=t.content,this.name=t.name,this.script=t.script,this.parent=t.parent,this.oldHtml=null,this.children=[],this.attrs=[],Object.defineProperties(this,{html:{get:function(){return this._html},set:function(t){this.script?(this.oldHtml=this._html||[],this._html=Array.prototype.map.call(t.childNodes,function(t){return t})):this._html=t}}}),t.script&&t.script.onChange(function(){var t=n.toHTML(),e=n.oldHtml[0];e||n.parent.children.forEach(function(t){t.script||e||(e=t.html),t==n&&(e=null)}),t.forEach(function(t){e?e.before(t):n.parent.html.append(t)}),n.oldHtml.forEach(function(t){t.remove()})}),t.attrs&&(this.attrs=Object.keys(t.attrs).map(function(r){var o=new i(r,t.attrs[r],e);return o.parts.forEach(function(t){t.script&&t.script.onChange(function(){n.html&&n.setAttribute(o.key)})}),o})),(t.children||[]).forEach(function(t){"text"==t.type?(e.scripts.forEach(function(r){var i=t.content.indexOf(r.original);if(i>-1){var s=t.content.substr(0,i);s&&n.children.push(new o({type:"text",content:s},e)),n.children.push(new o({type:"script",script:r,parent:n},e)),t.content=t.content.substr(i+r.original.length)}}),t.content&&n.children.push(new o({type:"text",content:t.content},e))):n.children.push(new o(t,e))})}o.prototype.render=function(){var t=null;if("text"==this.type)t=document.createTextNode(this.content);else if("script"==this.type){var e=this.script.value;t=document.createElement("container"),"string"==typeof e?t.append(document.createTextNode(e)):"object"==typeof e?e instanceof Array?e.forEach(function(e){e instanceof r?t.append(e.toHTML()):t.append(e)}):e instanceof r?t.append(e.toHTML()):t.append(e):t.append(document.createTextNode(e))}else t=document.createElement(this.name);return t},o.prototype.setAttribute=function(t){var e=this;this.attrs.forEach(function(n){null!=t&&n.key!=t||(n.setEvent(),n.event.key?(n.event.oldFn&&e.html.removeEventListener(n.event.key,n.event.oldFn),n.event.fn&&e.html.addEventListener(n.event.key,n.event.fn)):e.html.setAttribute(n.key,n.value()))})},o.prototype.toHTML=function(){var t=this;return this.html=this.render(),this.setAttribute(),this.children.forEach(function(e){e.script?e.toHTML().forEach(function(e){t.html.append(e)}):t.html.append(e.toHTML())}),this.html},e.exports=o},{"../juel/juel.js":7,"./attribute.js":9}],9:[function(t,e,n){function r(t,e,n,i){var o=this;this.key=t,this._value=e,this.script=i,this.parsered=n,this.parts=[],this.event={key:null,fn:null,oldFn:null},t&&n.scripts.forEach(function(t){var e=o._value.indexOf(t.original);if(e>-1){var n=o._value.substr(0,e);n&&o.parts.push(new r(null,n)),o.parts.push(new r(null,n,null,t)),o._value=o._value.substr(e+t.original.length)}})}r.prototype.value=function(){var t="";return this.parts.length?(this.parts.forEach(function(e){e.script?t+=e.script.value.toString():t+=e._value}),t+=this._value):t=this._value,t},r.prototype.setEvent=function(){1==this.parts.length&&"function"==typeof this.parts[0].script.value?(this.event.key=this.key,this.event.oldFn=this.fn,this.event.fn=this.parts[0].script.value):(this.oldFn=this.fn,this.fn=null)},e.exports=r},{}],10:[function(t,e,n){const r=t("./parser.js");e.exports=function(t){return new r(t)}},{"./parser.js":11}],11:[function(t,e,n){const r=t("html-parse-stringify"),i=t("./script.js"),o=t("./ast.js");function s(t){this.text=t,this.scripts=(this.text.match(new RegExp("(?:{{)(.*?)(?:}})","ig"))||[]).filter(function(t,e,n){return n.indexOf(t)===e}).map(function(t){return new i(t)}),this.ast=new o(r.parse(this.text)[0],this)}s.prototype.toHTML=function(){return this.ast.toHTML()},e.exports=s},{"./ast.js":8,"./script.js":12,"html-parse-stringify":16}],12:[function(t,e,n){function r(t){this.original=t,this.text=this.original.replace(new RegExp("({{)|(}})","g"),"").replace(new RegExp("&gt;"),">").replace(new RegExp("&lt;"),">"),this.value=null,this.first=!1,this.events={onChange:[]}}r.prototype.onChange=function(t){this.events.onChange.push(t)},r.prototype.exist=function(t){return this.text.indexOf(t)>-1},r.prototype.refresh=function(t){var e=this,n=new Function("scope","common","original","script",t.params+' try { return eval(script); } catch(err) { console.log(err); return ""; }')(t.scope,t.common,this.original,this.text);n!=this.value&&(this.value=n,this.first?this.events.onChange.forEach(function(t){t(e)}):this.first=!0)},e.exports=r},{}],13:[function(t,e,n){const r=t("./scope.js");e.exports=function(t){return t instanceof r?t:new r(t)}},{"./scope.js":14}],14:[function(t,e,n){function r(t){var e=this;this.keys=Object.keys(t),this.events={onChange:[]},this.keys.forEach(function(n){var r="_"+n;e[r]=t[n],Object.defineProperty(e,n,{get:function(){return e[r]},set:function(t){e[r]=t,e.events.onChange.forEach(function(e){e(n,t)})}})}),this.keys.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t}})})}r.prototype.onChange=function(t){this.events.onChange.push(t)},r.prototype.toJSON=function t(e){var n={};if(void 0!==e)e instanceof r&&(n=e.toJSON()),e instanceof Array?n=e.map(function(e){return t(e)}):"object"==typeof e?(Object.keys(e).forEach(function(r){n[r]=t(e[r])}),Object.getOwnPropertyNames(e).forEach(function(r){n[r]=t(e[r])})):n=e;else if(this instanceof r){var i=this;this.keys.forEach(function(e){n[e]=t(i["_"+e])})}return n},e.exports=r},{}],15:[function(t,e,n){var r={};(n={}).set=function(t,e){if("object"==typeof t&&t instanceof Array)t.forEach(function(t){n.set(t.name,t.html)});else if("string"==typeof t&&"string"==typeof e)r[t]=e;else if(!t)throw new Error("missing arguments")},n.read=function(){var t=document.querySelectorAll("[juel]");Array.prototype.forEach.call(t,function(t){n.set(t.getAttribute("juel"),t.innerHTML.trim()),t.remove()})},n.get=function(t){return r[t]||""},e.exports=n},{}],16:[function(t,e,n){e.exports={parse:t("./lib/parse"),stringify:t("./lib/stringify")}},{"./lib/parse":18,"./lib/stringify":19}],17:[function(t,e,n){var r=/([\w-]+)|['"]{1}([^'"]*)['"]{1}/g,i=Object.create?Object.create(null):{};i.area=!0,i.base=!0,i.br=!0,i.col=!0,i.embed=!0,i.hr=!0,i.img=!0,i.input=!0,i.keygen=!0,i.link=!0,i.menuitem=!0,i.meta=!0,i.param=!0,i.source=!0,i.track=!0,i.wbr=!0,e.exports=function(t){var e,n=0,o={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return t.replace(r,function(r){n%2?e=r:0===n?((i[r]||"/"===t.charAt(t.length-2))&&(o.voidElement=!0),o.name=r):o.attrs[e]=r.replace(/['"]/g,""),n++}),o}},{}],18:[function(t,e,n){var r=/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,i=t("./parse-tag"),o=Object.create?Object.create(null):{};e.exports=function(t,e){e||(e={}),e.components||(e.components=o);var n,s=[],c=-1,a=[],u={},p=!1;return t.replace(r,function(r,o){if(p){if(r!=="</"+n.name+">")return;p=!1}var h,l="/"!==r.charAt(1),f=o+r.length,m=t.charAt(f);if(l&&(c++,"tag"===(n=i(r)).type&&e.components[n.name]&&(n.type="component",p=!0),n.voidElement||p||!m||"<"===m||n.children.push({type:"text",content:t.slice(f,t.indexOf("<",f))}),u[n.tagName]=n,0===c&&s.push(n),(h=a[c-1])&&h.children.push(n),a[c]=n),(!l||n.voidElement)&&(c--,!p&&"<"!==m&&m)){h=-1===c?s:a[c].children;var d=t.indexOf("<",f),v=t.slice(f,-1===d?void 0:d);/^\s*$/.test(v)||h.push({type:"text",content:v})}}),s}},{"./parse-tag":17}],19:[function(t,e,n){function r(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?function(t){var e=[];for(var n in t)e.push(n+'="'+t[n]+'"');return e.length?" "+e.join(" "):""}(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(r,"")+"</"+e.name+">"}}e.exports=function(t){return t.reduce(function(t,e){return t+r("",e)},"")}},{}]},{},[1]);