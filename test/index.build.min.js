!function(){return function t(e,n,i){function o(c,s){if(!n[c]){if(!e[c]){var a="function"==typeof require&&require;if(!s&&a)return a(c,!0);if(r)return r(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return o(e[c][1][t]||t)},l,l.exports,t,e,n,i)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<i.length;c++)o(i[c]);return o}}()({1:[function(t,e,n){const i=t("./libs/juel"),o=t("./libs/parser"),r=t("./libs/evaluator"),c=t("./libs/template"),s=t("./libs/cache"),a=t("./libs/scope");(n={}).template=c,n.cache=s,n.get=s.get,n.append=function(t,e,i,o){var r=null;if(!t||"string"!=typeof t||"string"!=typeof e)throw new Error("missing arguments");return t=document.querySelector(t),(r=n.create(e,i,o)).static(t)?Array.prototype.forEach.call(r.toHTML().childNodes,function(e){t.append(e)}):t.append(r.toHTML()),r},n.create=function(t,e,n){var s,a=null,u=null;if("string"!=typeof t||"object"!=typeof e||n&&"object"!=typeof n)throw new Error("missing arguments");if(!(u=c.get(t)))throw new Error("empty html");return a=(s=o(u)).scripts.length>0?r(s,e,n):null,i(s,a)},n.scope=function(t){if("object"!=typeof t)throw new Error("parameter must be an object");return a(t)},e.exports=n},{"./libs/cache":2,"./libs/evaluator":4,"./libs/juel":5,"./libs/parser":9,"./libs/scope":12,"./libs/template":14}],2:[function(t,e,n){var i={};(n={}).set=function(t){i[t.id]=t},n.get=function(t){return i[t]},n.delete=function(t){delete i[t]},n.clear=function(){i={}},n.list=function(){return Object.keys(i).map(function(t){return n.get(t)})},e.exports=n},{}],3:[function(t,e,n){const i=t("../scope");function o(t,e,n){var o=this;this.scope=i(e),this.common=n,this.scripts=t.scripts,this.params=null,this.scope.onChange(function(t,e){o.refresh(t,e)})}o.prototype.refresh=function(t,e){var n=this;return this.params=this.scope.keys.map(function(t){return" var "+t+" = scope."+t+";"}).join(" "),this.common&&(this.params=this.params.concat(Object.keys(this.common).map(function(t){return" var "+t+" = common."+t+";"}).join(" "))),this.scripts.forEach(function(e){t&&!e.exist(t)||e.refresh(n)}),this},e.exports=o},{"../scope":12}],4:[function(t,e,n){const i=t("./evaluator.js");e.exports=function(t,e,n){return new i(t,e,n).refresh()}},{"./evaluator.js":3}],5:[function(t,e,n){const i=t("./juel.js");e.exports=function(t,e){return new i(t,e)}},{"./juel.js":6}],6:[function(t,e,n){const i=t("../cache");function o(t,e){this.id=null,this.parsered=t,this.evaluated=e,Object.defineProperties(this,{scope:{get:function(){return this.evaluated.scope}}})}o.prototype.toHTML=function(){return this.parsered.toHTML()},o.prototype.static=function(t){return this.parsered.static(t)},o.prototype.setId=function(t){return this.id=t,i.set(this),this},e.exports=o},{"../cache":2}],7:[function(t,e,n){const i=t("../juel/juel.js"),o=t("./attribute.js");function r(t,e){var n=this;this.type=t.type,this.content=t.content,this.name=t.name,this.script=t.script,this.parent=t.parent,this.oldHtml=null,this.children=[],this.attrs=[],this.static=null,Object.defineProperties(this,{html:{get:function(){return this._html},set:function(t){this.script?(this.oldHtml=this._html||[],this._html=Array.prototype.map.call(t.childNodes,function(t){return t})):this._html=t}}}),t.script&&t.script.onChange(function(){var t=n.toHTML(),e=n.oldHtml[0];e||n.parent.children.forEach(function(t){t.script||e||(e=t.html),t==n&&(e=null)}),t.forEach(function(t){e?e.before(t):n.parent.html.append(t)}),n.oldHtml.forEach(function(t){t.remove()})}),t.attrs&&(this.attrs=Object.keys(t.attrs).map(function(i){var r=new o(i,t.attrs[i],e);return r.parts.forEach(function(t){t.script&&t.script.onChange(function(){n.html&&n.setAttribute(r.key)})}),r})),(t.children||[]).forEach(function(t){"text"==t.type?(e.scripts.forEach(function(i){var o=t.content.indexOf(i.original);if(o>-1){var c=t.content.substr(0,o);c&&n.children.push(new r({type:"text",content:c},e)),n.children.push(new r({type:"script",script:i,parent:n},e)),t.content=t.content.substr(o+i.original.length)}}),t.content&&n.children.push(new r({type:"text",content:t.content},e))):n.children.push(new r(t,e))})}r.prototype.render=function(){var t=null;if("text"==this.type)t=document.createTextNode(this.content);else if("script"==this.type){var e=this.script.value;t=document.createElement("container"),"string"==typeof e?t.append(document.createTextNode(e)):"object"==typeof e?e instanceof Array?e.forEach(function(e){e instanceof i?t.append(e.toHTML()):t.append(e)}):e instanceof i?t.append(e.toHTML()):t.append(e):t.append(document.createTextNode(e))}else t=this.static||document.createElement(this.name);return t},r.prototype.setAttribute=function(t){var e=this;this.attrs.forEach(function(n){null!=t&&n.key!=t||(n.setEvent(),n.event.key?(n.event.oldFn&&e.html.removeEventListener(n.event.key,n.event.oldFn),n.event.fn&&e.html.addEventListener(n.event.key,n.event.fn)):e.html.setAttribute(n.key,n.value()))})},r.prototype.toHTML=function(){var t=this;return this.html=this.render(),this.setAttribute(),this.children.forEach(function(e){e.script?e.toHTML().forEach(function(e){t.html.append(e)}):t.html.append(e.toHTML())}),this.html},e.exports=r},{"../juel/juel.js":6,"./attribute.js":8}],8:[function(t,e,n){function i(t,e,n,o){var r=this;this.key=t,this._value=e,this.script=o,this.parsered=n,this.parts=[],this.event={key:null,fn:null,oldFn:null},t&&n.scripts.forEach(function(t){var e=r._value.indexOf(t.original);if(e>-1){var n=r._value.substr(0,e);n&&r.parts.push(new i(null,n)),r.parts.push(new i(null,n,null,t)),r._value=r._value.substr(e+t.original.length)}})}i.prototype.value=function(){var t="";return this.parts.length?(this.parts.forEach(function(e){e.script?t+=e.script.value.toString():t+=e._value}),t+=this._value):t=this._value,t},i.prototype.setEvent=function(){1==this.parts.length&&"function"==typeof this.parts[0].script.value?(this.event.key=this.key,this.event.oldFn=this.fn,this.event.fn=this.parts[0].script.value):(this.oldFn=this.fn,this.fn=null)},e.exports=i},{}],9:[function(t,e,n){const i=t("./parser.js");e.exports=function(t){return new i(t)}},{"./parser.js":10}],10:[function(t,e,n){const i=t("html-parse-stringify"),o=t("./script.js"),r=t("./ast.js");function c(t){this.text=t,this.scripts=(this.text.match(new RegExp("(?:{{)(.*?)(?:}})","ig"))||[]).filter(function(t,e,n){return n.indexOf(t)===e}).map(function(t){return new o(t)}),this.ast=new r(i.parse(this.text)[0],this)}c.prototype.toHTML=function(){return this.ast.toHTML()},c.prototype.static=function(t){return"juel"==this.ast.name&&(this.ast.static=t,!0)},e.exports=c},{"./ast.js":7,"./script.js":11,"html-parse-stringify":15}],11:[function(t,e,n){function i(t){this.original=t,this.text=this.original.replace(new RegExp("({{)|(}})","g"),"").replace(new RegExp("&gt;"),">").replace(new RegExp("&lt;"),">"),this.value=null,this.first=!1,this.events={onChange:[]}}i.prototype.onChange=function(t){this.events.onChange.push(t)},i.prototype.exist=function(t){return this.text.indexOf(t)>-1},i.prototype.refresh=function(t){var e=this,n=new Function("scope","common","original","script",t.params+' try { return eval(script); } catch(err) { console.log(err); return ""; }')(t.scope,t.common,this.original,this.text);n!=this.value&&(this.value=n,this.first?this.events.onChange.forEach(function(t){t(e)}):this.first=!0)},e.exports=i},{}],12:[function(t,e,n){const i=t("./scope.js");e.exports=function(t){return t instanceof i?t:new i(t)}},{"./scope.js":13}],13:[function(t,e,n){function i(t){var e=this;this.keys=Object.keys(t),this.events={onChange:[]},this.keys.forEach(function(n){var i="_"+n;e[i]=t[n],Object.defineProperty(e,n,{get:function(){return e[i]},set:function(t){e[i]=t,e.events.onChange.forEach(function(e){e(n,t)})}})}),this.keys.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t}})})}i.prototype.onChange=function(t){this.events.onChange.push(t)},i.prototype.toJSON=function t(e){var n={};if(void 0!==e)e instanceof i&&(n=e.toJSON()),e instanceof Array?n=e.map(function(e){return t(e)}):"object"==typeof e?(Object.keys(e).forEach(function(i){n[i]=t(e[i])}),Object.getOwnPropertyNames(e).forEach(function(i){n[i]=t(e[i])})):n=e;else if(this instanceof i){var o=this;this.keys.forEach(function(e){n[e]=t(o["_"+e])})}return n},e.exports=i},{}],14:[function(t,e,n){var i={};(n={}).set=function(t,e){if("object"==typeof t&&t instanceof Array)t.forEach(function(t){n.set(t.name,t.html)});else if("string"==typeof t&&"string"==typeof e)i[t]=e;else if(!t)throw new Error("missing arguments")},n.read=function(){var t=document.querySelectorAll("[juel]");Array.prototype.forEach.call(t,function(t){n.set(t.getAttribute("juel"),t.innerHTML.trim()),t.remove()})},n.get=function(t){return i[t]||""},e.exports=n},{}],15:[function(t,e,n){e.exports={parse:t("./lib/parse"),stringify:t("./lib/stringify")}},{"./lib/parse":17,"./lib/stringify":18}],16:[function(t,e,n){var i=/([\w-]+)|['"]{1}([^'"]*)['"]{1}/g,o=Object.create?Object.create(null):{};o.area=!0,o.base=!0,o.br=!0,o.col=!0,o.embed=!0,o.hr=!0,o.img=!0,o.input=!0,o.keygen=!0,o.link=!0,o.menuitem=!0,o.meta=!0,o.param=!0,o.source=!0,o.track=!0,o.wbr=!0,e.exports=function(t){var e,n=0,r={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return t.replace(i,function(i){n%2?e=i:0===n?((o[i]||"/"===t.charAt(t.length-2))&&(r.voidElement=!0),r.name=i):r.attrs[e]=i.replace(/['"]/g,""),n++}),r}},{}],17:[function(t,e,n){var i=/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,o=t("./parse-tag"),r=Object.create?Object.create(null):{};e.exports=function(t,e){e||(e={}),e.components||(e.components=r);var n,c=[],s=-1,a=[],u={},l=!1;return t.replace(i,function(i,r){if(l){if(i!=="</"+n.name+">")return;l=!1}var p,h="/"!==i.charAt(1),f=r+i.length,d=t.charAt(f);if(h&&(s++,"tag"===(n=o(i)).type&&e.components[n.name]&&(n.type="component",l=!0),n.voidElement||l||!d||"<"===d||n.children.push({type:"text",content:t.slice(f,t.indexOf("<",f))}),u[n.tagName]=n,0===s&&c.push(n),(p=a[s-1])&&p.children.push(n),a[s]=n),(!h||n.voidElement)&&(s--,!l&&"<"!==d&&d)){p=-1===s?c:a[s].children;var m=t.indexOf("<",f),g=t.slice(f,-1===m?void 0:m);/^\s*$/.test(g)||p.push({type:"text",content:g})}}),c}},{"./parse-tag":16}],18:[function(t,e,n){function i(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?function(t){var e=[];for(var n in t)e.push(n+'="'+t[n]+'"');return e.length?" "+e.join(" "):""}(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(i,"")+"</"+e.name+">"}}e.exports=function(t){return t.reduce(function(t,e){return t+i("",e)},"")}},{}],19:[function(t,e,n){const i=t("../index.js"),o=t("../libs/scope/scope.js");var r=null;mocha.setup("bdd"),describe("index.js test",function(){it("add templates to juel",function(t){try{i.template.read(),i.template.set("scopeShowBtn",'<button click="{{click}}">Show Scope On Console</button>'),i.template.set([{name:"changeListBtn",html:'<button id="changeListBtn" click="{{ click }}">Change List</button>'},{name:"countItem",html:'<li>{{ text }}{{ count ? " - " + count + " Time" + (count > 1 ? "s": "") + " Clicked" : "" }}</li>'},{name:"countList",html:"<ul>Clicked Counts {{ todoList.map(addItem) }} NOT: if not clicked, number doesnt show</ul>"}]),'<button click="{{click}}">Show Scope On Console</button>'==i.template.get("scopeShowBtn")&&"<ul>Click Items {{ todoList.map(addItem) }}</ul>"==i.template.get("todoList")&&'<button id="changeListBtn" click="{{ click }}">Change List</button>'==i.template.get("changeListBtn")?t():t(new Error("add templates to juel failed."))}catch(e){t(e)}}),it("create scope for global",function(t){try{var e=[{id:1,text:"Item1",count:0},{id:2,text:"Item2",count:0},{id:3,text:"Item3",count:0}];(r=i.scope({todoList:e}))instanceof o&&r.todoList==e&&1==r.keys.length?t():t(new Error("create scope for global failed."))}catch(e){t(e)}}),it("append template to container and test click",function(t){try{i.append("#changeList","changeListBtn",{},{click:function(e){t()}}),'<button id="changeListBtn">Change List</button>'==document.getElementById("changeList").innerHTML?document.getElementById("changeListBtn").dispatchEvent(new Event("click")):t(new Error("append template to container failed."))}catch(e){t(e)}}),it("append template and create sub template from script in parent template",function(t){try{function e(t){}i.append("#todoList","todoList",r,{addItem:function(t){return i.create("todoItem",t,{click:e}).toHTML()}});"<ul>Click Items <li><button>Item1</button></li><li><button>Item2</button></li><li><button>Item3</button></li></ul>"==document.getElementById("todoList").innerHTML?t():t(new Error("append template and create sub template from script in parent template failed."))}catch(e){t(e)}}),it("test click for sub template and check scope",function(t){try{document.getElementById("todoList").innerHTML="",i.append("#todoList","todoList",r,{addItem:function(e){return i.create("todoItem",e,{click:function(e){this==r.todoList[0]?t():t(new Error("check scope failed."))}.bind(e)}).toHTML()}}),document.querySelector("#todoList li button").dispatchEvent(new Event("click"))}catch(e){t(e)}}),it("set id for juel instance and check instance with cache",function(t){try{function e(t){}document.getElementById("todoList").innerHTML="",i.append("#todoList","todoList",r,{addItem:function(t){return i.create("todoItem",t,{click:e}).toHTML()}}).setId("todoList")==i.get("todoList")?t():t(new Error("check instance with cache failed."))}catch(e){t(e)}}),it("change scope",function(t){try{var e=[{id:1,text:"Item1",count:0},{id:2,text:"Item2",count:0},{id:3,text:"Item3",count:0},{id:4,text:"Item4",count:0},{id:5,text:"Item5",count:0}];function n(t){}document.getElementById("changeList").innerHTML="",document.getElementById("todoList").innerHTML="",i.append("#changeList","changeListBtn",{},{click:function(t){r.todoList=e}}),i.append("#todoList","todoList",r,{addItem:function(t){return i.create("todoItem",t,{click:n}).toHTML()}});document.getElementById("changeListBtn").dispatchEvent(new Event("click")),r.todoList==e&&"<ul>Click Items <li><button>Item1</button></li><li><button>Item2</button></li><li><button>Item3</button></li><li><button>Item4</button></li><li><button>Item5</button></li></ul>"==document.getElementById("todoList").innerHTML?t():t(new Error("change scope failed."))}catch(e){t(e)}}),it("change sub template scope",function(t){try{document.getElementById("todoList").innerHTML="",r=i.scope({todoList:[{id:1,text:"Item1",count:0},{id:2,text:"Item2",count:0},{id:3,text:"Item3",count:0}]}),i.append("#todoList","todoList",r,{addItem:function(e){return i.create("todoItem",e,{click:function(e){this.count+=1,1==r.todoList[0].count&&"<ul>Clicked Counts <li>Item1 - 1 Time Clicked</li><li>Item2</li><li>Item3</li> NOT: if not clicked, number doesnt show</ul>"==document.getElementById("countList").innerHTML?t():t(new Error("change sub template scope failed."))}.bind(e)}).toHTML()}}),i.append("#countList","countList",r,{addItem:function(t){return i.create("countItem",t).toHTML()}}),document.querySelector("#todoList li button").dispatchEvent(new Event("click"))}catch(e){t(e)}}),it("check scope to JSON",function(t){try{'{"todoList":[{"id":1,"text":"Item1","count":1},{"id":2,"text":"Item2","count":0},{"id":3,"text":"Item3","count":0}]}'==JSON.stringify(r.toJSON())?t():t(new Error("check scope to JSON failed."))}catch(e){t(e)}}),it("juel container disappears",function(t){try{i.template.set("juelContainer","<juel>{{ value }}</juel>"),i.append("#juelContainerTest","juelContainer",{value:"juelContainerTest"}),"juelContainerTest"==document.getElementById("juelContainerTest").innerHTML?t():t(new Error("Fail!"))}catch(e){t(e)}}),it("juel container and scope change",function(t){try{i.template.set("juelContainer","<juel>{{ value }}</juel>");var e=i.scope({value:"juelContainerTest"});i.append("#juelContainerTest2","juelContainer",e),e.value="juelContainerTest2","juelContainerTest2"==document.getElementById("juelContainerTest2").innerHTML?t():t(new Error("Fail!"))}catch(e){t(e)}})}),mocha.checkLeaks(),mocha.run()},{"../index.js":1,"../libs/scope/scope.js":13}]},{},[19]);